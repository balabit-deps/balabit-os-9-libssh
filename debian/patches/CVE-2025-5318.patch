Backport of:

From 5f4ffda88770f95482fd0e66aa44106614dbf466 Mon Sep 17 00:00:00 2001
From: Jakub Jelen <jjelen@redhat.com>
Date: Tue, 22 Apr 2025 21:18:44 +0200
Subject: CVE-2025-5318: sftpserver: Fix possible buffer overrun

Signed-off-by: Jakub Jelen <jjelen@redhat.com>
Reviewed-by: Andreas Schneider <asn@cryptomilk.org>
---
 src/sftpserver.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

--- a/src/sftpserver.c
+++ b/src/sftpserver.c
@@ -538,7 +538,7 @@ void *sftp_handle(sftp_session sftp, ssh
 
   memcpy(&val, ssh_string_data(handle), sizeof(uint32_t));
 
-  if (val > SFTP_HANDLES) {
+  if (val >= SFTP_HANDLES) {
     return NULL;
   }
 
