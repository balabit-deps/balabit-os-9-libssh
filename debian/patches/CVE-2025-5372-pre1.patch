Backport of:

From f13b91c2d87f2b75540ebdc93b8958594976e985 Mon Sep 17 00:00:00 2001
From: Jakub Jelen <jjelen@redhat.com>
Date: Wed, 14 May 2025 13:57:24 +0200
Subject: libgcrypto: Reformat ssh_kdf()

Signed-off-by: Jakub Jelen <jjelen@redhat.com>
Reviewed-by: Andreas Schneider <asn@cryptomilk.org>
---
 src/libcrypto.c | 33 ++++++++++++++++++++++-----------
 1 file changed, 22 insertions(+), 11 deletions(-)

--- a/src/libcrypto.c
+++ b/src/libcrypto.c
@@ -414,7 +414,8 @@ int ssh_kdf(struct ssh_crypto_struct *cr
         return -1;
     }
 
-    rc = EVP_KDF_ctrl(ctx, EVP_KDF_CTRL_SET_MD,
+    rc = EVP_KDF_ctrl(ctx,
+                      EVP_KDF_CTRL_SET_MD,
                       sshkdf_digest_to_md(crypto->digest_type));
     if (rc != 1) {
         goto out;
@@ -423,8 +424,10 @@ int ssh_kdf(struct ssh_crypto_struct *cr
     if (rc != 1) {
         goto out;
     }
-    rc = EVP_KDF_ctrl(ctx, EVP_KDF_CTRL_SET_SSHKDF_XCGHASH,
-                      crypto->secret_hash, crypto->digest_len);
+    rc = EVP_KDF_ctrl(ctx,
+                      EVP_KDF_CTRL_SET_SSHKDF_XCGHASH,
+                      crypto->secret_hash,
+                      crypto->digest_len);
     if (rc != 1) {
         goto out;
     }
@@ -432,8 +435,10 @@ int ssh_kdf(struct ssh_crypto_struct *cr
     if (rc != 1) {
         goto out;
     }
-    rc = EVP_KDF_ctrl(ctx, EVP_KDF_CTRL_SET_SSHKDF_SESSION_ID,
-                      crypto->session_id, crypto->session_id_len);
+    rc = EVP_KDF_ctrl(ctx,
+                      EVP_KDF_CTRL_SET_SSHKDF_SESSION_ID,
+                      crypto->session_id,
+                      crypto->session_id_len);
     if (rc != 1) {
         goto out;
     }
